<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} - {{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>
<body>
  <div class="container">
    <!-- Sidebar with TOC -->
    <aside class="sidebar" id="sidebar">
      <nav class="toc">
        <h3>目錄</h3>
        <div id="toc-content"></div>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="content">
      <h1>{{ page.title }}</h1>
      {{ content }}
    </main>
  </div>

  <script>
    // 自動生成目錄
    window.addEventListener('DOMContentLoaded', () => {
      const content = document.querySelector('.content');
      const tocContent = document.getElementById('toc-content');
      const headings = content.querySelectorAll('h2, h3');
      
      if (headings.length === 0) {
        document.getElementById('sidebar').style.display = 'none';
        return;
      }

      const ul = document.createElement('ul');
      
      headings.forEach((heading, index) => {
        // 為標題加上 id
        if (!heading.id) {
          heading.id = 'heading-' + index;
        }
        
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.textContent = heading.textContent;
        a.href = '#' + heading.id;
        
        // h3 縮排
        if (heading.tagName === 'H3') {
          li.className = 'toc-h3';
        }
        
        li.appendChild(a);
        ul.appendChild(li);
      });
      
      tocContent.appendChild(ul);
    });
  </script>
</body>
</html>
